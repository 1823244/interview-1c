# Исходный код

// Качество кода
// Что не так с кодом

&НаКлиенте
Процедура РассчитатьДатуДоставки(ВыделенныеСтрокиСписка)
    
    Для Каждого Элемент Из ВыделенныеСтрокиСписка Цикл
    
        ДатаДоставки = РассчитатьДатуДоставкиНаСервере();
        Склады = ПолучитьСкладыРегиона(Элемент.Регион);

    КонецЦикла;

КонецПроцедуры

&НаСервере
Функция РассчитатьДатуДоставкиНаСервере()
    ДатаДоставки = ТекущаяДатаСеанса() + 7 * 86400;
    Возврат ДатаДоставки;
КонецФункции

&НаСервере
Функция ПолучитьСкладыРегиона(Регион)
    Склады = Справочники.Склады.НайтиПоРеквизиту("Регион, Регион);
    Возврат Склады;
КонецФункции

---------------
# Исправление

&НаКлиенте
Процедура РассчитатьДатуДоставки(ВыделенныеСтрокиСписка)
    
    Регионы = Новый Массив;
    Для Каждого Элемент Из ВыделенныеСтрокиСписка Цикл

        Регионы.Добавить(Элемент.Регион);
    
        ДатаДоставки = РассчитатьДатуДоставкиНаСервере();
        Склады = ПолучитьСкладыРегиона(Элемент.Регион);

    КонецЦикла;

КонецПроцедуры

&НаСервереБезКонтекста // меняем вызов на внеконтекстный
Функция РассчитатьДатуДоставкиНаСервере()
    ДатаДоставки = ТекущаяДатаСеанса() + 7 * 86400;
    Возврат ДатаДоставки;
КонецФункции

&НаСервереБезКонтекста
Функция ПолучитьСкладыРегиона(Регион)

    // найдет один склад!
    // Возвращаемое значение:
        //Тип: СправочникСсылка.<Имя справочника>. 
        //Ссылка на найденный элемент справочника. Если не существует ни одного элемента с 
        //требуемым значением реквизита, то будет возвращена пустая ссылка.
    //Склады = Справочники.Склады.НайтиПоРеквизиту("Регион, Регион);
    //Возврат Склады;
    
    Возврат ОбщийМодульПовтИсп.ПолучитьСкладыРегиона(Регион);
    
КонецФункции

// В общем модуле с признаком ПовтИсп
Функция ПолучитьСкладыРегиона(Регион) Экспорт

    Запрос  = Новый Запрос;
    Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |    Ссылка КАК Ссылка
    |ИЗ
    |    Справочник.Склады
    |ГДЕ
    |    Регион = &Регион";
    Запрос.УстановитьПараметр("Регион", Регион);
    Рез = Запрос.Выполнить();
    Если Рез.Пустой() Тогда
        Возврат Новый Массив;
    КонецЕсли;

    Возврат Рез.Выгрузить().ВыгрузитьКолонку("Ссылка");
    
КонецФункции